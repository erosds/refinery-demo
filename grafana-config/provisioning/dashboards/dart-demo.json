{
  "dashboard": {
    "id": null,
    "title": "demo Demo - Human vs AI Refinery Optimization",
    "tags": ["demo", "demo", "ai", "refinery"],
    "timezone": "browser",
    "refresh": "5s",
    "time": {
      "from": "now-1h",
      "to": "now"
    },
    "panels": [
      {
        "id": 1,
        "title": "ðŸŽ¯ BIT-TQ Penetrazione Bitume (KPI Principale)",
        "type": "timeseries",
        "gridPos": {"h": 8, "w": 12, "x": 0, "y": 0},
        "targets": [
          {
            "datasource": "TimescaleDB",
            "rawSql": "SELECT timestamp as time, bit_tq as \"Attuale\" FROM process_data WHERE $__timeFilter(timestamp) ORDER BY timestamp",
            "refId": "Current"
          },
          {
            "datasource": "TimescaleDB", 
            "rawSql": "SELECT timestamp as time, predicted_bit_tq as \"AI Target\" FROM ai_decisions WHERE $__timeFilter(timestamp) AND predicted_bit_tq IS NOT NULL ORDER BY timestamp",
            "refId": "AI_Target"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "dmm",
            "min": 35,
            "max": 65,
            "thresholds": {
              "steps": [
                {"color": "red", "value": 35},
                {"color": "yellow", "value": 48},
                {"color": "green", "value": 50},
                {"color": "blue", "value": 55}
              ]
            }
          },
          "overrides": [
            {
              "matcher": {"id": "byName", "options": "AI Target"},
              "properties": [
                {"id": "color", "value": {"mode": "fixed", "fixedColor": "blue"}},
                {"id": "custom.lineStyle", "value": {"dash": [10, 10]}}
              ]
            }
          ]
        }
      },
      {
        "id": 2,
        "title": "ðŸ¤– AI Decision Status",
        "type": "stat",
        "gridPos": {"h": 4, "w": 6, "x": 12, "y": 0},
        "targets": [
          {
            "datasource": "TimescaleDB",
            "rawSql": "SELECT confidence * 100 as \"AI Confidence %\" FROM ai_decisions ORDER BY timestamp DESC LIMIT 1",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "percent",
            "thresholds": {
              "steps": [
                {"color": "red", "value": 0},
                {"color": "yellow", "value": 70},
                {"color": "green", "value": 80}
              ]
            }
          }
        }
      },
      {
        "id": 3,
        "title": "ðŸ’° Savings Today",
        "type": "stat", 
        "gridPos": {"h": 4, "w": 6, "x": 18, "y": 0},
        "targets": [
          {
            "datasource": "TimescaleDB",
            "rawSql": "SELECT SUM(savings_eur_hour) as \"â‚¬/Hour\" FROM ai_decisions WHERE timestamp > NOW() - INTERVAL '1 day' AND decision_applied = true",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "currencyEUR",
            "color": {"mode": "thresholds"},
            "thresholds": {
              "steps": [
                {"color": "gray", "value": 0},
                {"color": "yellow", "value": 500},
                {"color": "green", "value": 1000}
              ]
            }
          }
        }
      },
      {
        "id": 4,
        "title": "âš¡ Consumo Energia vs Efficienza",
        "type": "timeseries",
        "gridPos": {"h": 8, "w": 12, "x": 12, "y": 4},
        "targets": [
          {
            "datasource": "TimescaleDB",
            "rawSql": "SELECT timestamp as time, energy_consumption as \"Energia (MWh)\" FROM process_data WHERE $__timeFilter(timestamp) ORDER BY timestamp",
            "refId": "Energy"
          },
          {
            "datasource": "TimescaleDB",
            "rawSql": "SELECT timestamp as time, process_efficiency as \"Efficienza (%)\" FROM process_data WHERE $__timeFilter(timestamp) ORDER BY timestamp", 
            "refId": "Efficiency"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "custom": {"axisPlacement": "auto"}
          },
          "overrides": [
            {
              "matcher": {"id": "byName", "options": "Energia (MWh)"},
              "properties": [
                {"id": "color", "value": {"mode": "fixed", "fixedColor": "orange"}},
                {"id": "custom.axisLabel", "value": "MWh"}
              ]
            },
            {
              "matcher": {"id": "byName", "options": "Efficienza (%)"},
              "properties": [
                {"id": "color", "value": {"mode": "fixed", "fixedColor": "green"}},
                {"id": "custom.axisLabel", "value": "%"},
                {"id": "unit", "value": "percent"}
              ]
            }
          ]
        }
      },
      {
        "id": 5,
        "title": "ðŸŒ± Impatto Ambientale",
        "type": "timeseries",
        "gridPos": {"h": 6, "w": 8, "x": 0, "y": 8},
        "targets": [
          {
            "datasource": "TimescaleDB",
            "rawSql": "SELECT timestamp as time, co2_emissions as \"CO2 (ton/h)\" FROM process_data WHERE $__timeFilter(timestamp) ORDER BY timestamp",
            "refId": "CO2"
          },
          {
            "datasource": "TimescaleDB",
            "rawSql": "SELECT timestamp as time, hvbgo_flow as \"Ricircolo HVbGO\" FROM process_data WHERE $__timeFilter(timestamp) ORDER BY timestamp",
            "refId": "Recycle"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "color": {"mode": "palette-classic"}
          }
        }
      },
      {
        "id": 6,
        "title": "ðŸ“Š Human vs AI Performance",
        "type": "table",
        "gridPos": {"h": 6, "w": 8, "x": 8, "y": 8},
        "targets": [
          {
            "datasource": "TimescaleDB",
            "rawSql": "SELECT * FROM human_vs_ai_performance WHERE hour > NOW() - INTERVAL '24 hours' ORDER BY hour DESC LIMIT 10",
            "refId": "Performance"
          }
        ],
        "fieldConfig": {
          "overrides": [
            {
              "matcher": {"id": "byName", "options": "performance_winner"},
              "properties": [
                {
                  "id": "custom.cellOptions",
                  "value": {
                    "type": "color-background",
                    "mode": "basic"
                  }
                },
                {
                  "id": "mappings",
                  "value": [
                    {"options": {"AI_BETTER": {"color": "green", "index": 0}}, "type": "value"},
                    {"options": {"HUMAN_BETTER": {"color": "red", "index": 1}}, "type": "value"},
                    {"options": {"TIE": {"color": "yellow", "index": 2}}, "type": "value"}
                  ]
                }
              ]
            }
          ]
        }
      },
      {
        "id": 7,
        "title": "ðŸš¨ Anomalie e Alert",
        "type": "logs",
        "gridPos": {"h": 6, "w": 8, "x": 16, "y": 8},
        "targets": [
          {
            "datasource": "TimescaleDB",
            "rawSql": "SELECT timestamp, anomaly_type, severity, parameter_name, actual_value, auto_resolved FROM anomalies WHERE timestamp > NOW() - INTERVAL '24 hours' ORDER BY timestamp DESC",
            "refId": "Anomalies"
          }
        ]
      },
      {
        "id": 8,
        "title": "ðŸ’¡ AI Recommendations Live",
        "type": "text",
        "gridPos": {"h": 4, "w": 12, "x": 0, "y": 14},
        "options": {
          "content": "## ðŸ¤– Latest AI Recommendation\n\n**Status**: Monitoring process parameters...\n\n**Action**: Optimizing fc1065 (+4.3%), li40054 (+4.8%), fc31007 (-2.7%)\n\n**Impact**: BIT-TQ 45.2 â†’ 52.1 dmm, Energy -5%, CO2 -12%\n\n**Confidence**: 81% (RÂ²=0.77)",
          "mode": "markdown"
        }
      },
      {
        "id": 9,
        "title": "ðŸ“ˆ ROI Calculator",
        "type": "table",
        "gridPos": {"h": 4, "w": 12, "x": 12, "y": 14},
        "targets": [
          {
            "datasource": "TimescaleDB",
            "rawSql": "SELECT day, daily_savings_eur as \"Daily â‚¬\", energy_saved_mwh as \"Energy Saved\", co2_avoided_tons as \"CO2 Avoided\", ai_decisions_count as \"AI Decisions\" FROM savings_calculator ORDER BY day DESC LIMIT 7",
            "refId": "ROI"
          }
        ]
      }
    ],
    "annotations": {
      "list": [
        {
          "name": "AI Decisions",
          "datasource": "TimescaleDB",
          "enable": true,
          "target": {
            "rawSql": "SELECT timestamp as time, 'AI Decision Applied' as text, confidence as tags FROM ai_decisions WHERE $__timeFilter(timestamp) AND decision_applied = true"
          }
        }
      ]
    }
  }
}